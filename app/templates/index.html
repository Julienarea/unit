<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RatingHabits</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <link rel="icon" href="../static/images/logo.png" type="image/x-icon">
</head>
<body>
  <header class="header">
    <nav class="nav-items">
      <ul>
        <li class="active-nav-item">–ì–ª–∞–≤–Ω–∞—è</li>
        <a href="{{ url_for('aboutus') }}"><li>–û –Ω–∞—Å</li></a>
        <a href="{{ url_for('rating') }}"><li>–†–µ–π—Ç–∏–Ω–≥</li></a>
        <!-- <li>–ö–æ–Ω—Ç–∞–∫—Ç—ã</li> -->
        <!-- <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</li> -->
        <li class="logout-btn"><a href="{{ url_for('logout') }}">–í—ã–π—Ç–∏</a></li>
      </ul>
    </nav>
  </header>
  <div class="app-header">
        <section class="avatar new_block card">
            <img src="{{ user.avatar }}" alt="–ê–≤–∞—Ç–∞—Ä" class="avatar-img" />
            <div class="nickname">{{ user.nickname }}</div>
            <div class="username">@{{ user.username }}</div>
        </section>
        <section class="rating new_block card">
            <div class="rating-title">
                <span>–†–ï–ô–¢–ò–ù–ì</span>
            </div>
            <div class="rating-value profile-rating-value">{{ user.rating }}</div>
            <div class="rating-bar">
                <div class="rating-bar-fill" style="width: {{ user.rating/20 }}%;"></div>
            </div>
        </section>
  </div>

  <main class="container">

    <section class="tasks block card">
      <div class="card-head">
        <div class="section-title">–ó–ê–î–ê–ß–ò</div>
        <button class="icon-btn" id="add-task-btn">
          <img src="../static/images/btnplus.png" class="icon" alt="–ö–Ω–æ–ø–∫–∞" />
        </button>
      </div>
      <div class="card-filters">
        <div class="filter active" data-filter="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
        <div class="filter" data-filter="completed">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</div>
      </div>
      <ul class="tasks-list">
        {% for task in user.tasks %}
        <li class="task-item" data-status="{{ task.status }}" data-task-id="{{ task.id }}">
          <div class="task-wrapper">
            <div class="task-left-control">
              <label class="checkbox-container">
                <input type="checkbox" class="task-checkbox" {% if task.status == 'completed' %}checked{% endif %} data-task-id="{{ task.id }}" data-task-title="{{ task.title }}">
                <span class="checkmark"></span>
              </label>
            </div>
            <div class="task-content" data-task-id="{{ task.id }}">
              <h3 class="task-title">{{ task.title }}</h3>
              {% if task.notes %}
              <div class="task-notes">{{ task.notes }}</div>
              {% endif %}
              <div class="task-meta">
                {% if task.difficulty %}
                <span class="task-difficulty task-difficulty-{{ task.difficulty }}">
                  {% if task.difficulty == 'trivial' %}‚≠ê –ü—É—Å—Ç—è–∫
                  {% elif task.difficulty == 'easy' %}‚≠ê‚≠ê –õ–µ–≥–∫–æ
                  {% elif task.difficulty == 'medium' %}‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ
                  {% elif task.difficulty == 'hard' %}‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ
                  {% endif %}
                </span>
                {% endif %}
                {% if task.deadline %}
                <span class="task-deadline">üìÖ {{ task.deadline }}</span>
                {% endif %}
              </div>
            </div>
            <div class="task-actions">
              <button class="task-menu-btn" data-task-id="{{ task.id }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 16" width="16" height="16">
                  <path fill="#686274" fill-rule="evenodd" d="M2 4a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"></path>
                </svg>
              </button>
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>
    </section>

    <section class="habits block card">
      <div class="card-head">
        <div class="section-title">–ü–†–ò–í–´–ß–ö–ò</div>
        <button class="icon-btn">
          <img src="../static/images/btnplus.png" class="icon" alt="–ö–Ω–æ–ø–∫–∞" />
        </button>
      </div>
      <div class="card-filters">
        <div class="filter" data-filter="all">–í—Å–µ</div>
        <div class="filter active" data-filter="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
        <div class="filter" data-filter="completed">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</div>
      </div>
      <ul class="habits-list">
        {% for habit in user.habits %}
        <li class="habit-item{% if not habit.active %} habit-inactive{% endif %}" data-habit-id="{{ habit.id }}" data-status="{% if not habit.active %}inactive{% elif (habit.streak or 0) > 0 %}completed{% else %}in_progress{% endif %}">
          <div class="habit-wrapper">
            <div class="habit-left-control">
              <label class="checkbox-container">
                <input type="checkbox" class="habit-checkbox" {% if (habit.streak or 0) > 0 %}checked{% endif %} data-habit-id="{{ habit.id }}" data-habit-title="{{ habit.title }}">
                <span class="checkmark"></span>
              </label>
            </div>
            <div class="habit-content" data-habit-id="{{ habit.id }}">
              <h3 class="habit-title">{{ habit.title }}</h3>
              {% if habit.notes %}
              <div class="habit-notes">{{ habit.notes }}</div>
              {% endif %}
              <div class="habit-meta">
                <span class="habit-streak-badge">üî• –°–µ—Ä–∏—è: {{ habit.streak }}</span>
                {% if habit.difficulty %}
                <span class="habit-difficulty habit-difficulty-{{ habit.difficulty }}">
                  {% if habit.difficulty == 'trivial' %}‚≠ê –ü—É—Å—Ç—è–∫
                  {% elif habit.difficulty == 'easy' %}‚≠ê‚≠ê –õ–µ–≥–∫–æ
                  {% elif habit.difficulty == 'medium' %}‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ
                  {% elif habit.difficulty == 'hard' %}‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ
                  {% endif %}
                </span>
                {% endif %}
              </div>
            </div>
            <div class="habit-actions">
              <button class="habit-menu-btn" data-habit-id="{{ habit.id }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 16" width="16" height="16">
                  <path fill="#686274" fill-rule="evenodd" d="M2 4a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"></path>
                </svg>
              </button>
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>
    </section>

    <section class="achievements block card">
        <div class="card-head">
            <div class="section-title">
                –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
            </div>
      </div>
      <ul class="achievements-list">
        {% for ach in user.achievements %}
        <li class="achievement-item">
          <span class="achievement-title">{{ ach.title }}</span>
          <span class="achievement-desc">{{ ach.description }}</span>
        </li>
        {% endfor %}
      </ul>
    </section>

  </main>

  <footer class="footer">
    <span>–Æ–ù–ò–¢.–£–†–§–£</span>
  </footer>

  <!-- Overlay –∏ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
  <div id="modal-overlay" class="modal-overlay" style="display: none"></div>
  <div id="modal-task" class="modal" style="display: none">
    <div class="modal-content">
      <div class="modal-header">
        <h2>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h2>
        <div class="modal-header-actions">
          <button id="task-cancel-btn" class="modal-btn-secondary cancel">–û—Ç–º–µ–Ω–∞</button>
          <button id="task-create-btn" class="modal-btn">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="task-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫*</label>
          <input type="text" id="task-title" placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ" class="form-input" required />
        </div>
        <div class="form-group">
          <label for="task-notes">–ó–∞–º–µ—Ç–∫–∏</label>
          <textarea id="task-notes" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" class="form-input" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="task-difficulty">–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
          <select id="task-difficulty" class="form-input">
            <option value="trivial">‚≠ê –ü—É—Å—Ç—è–∫</option>
            <option value="easy" selected>‚≠ê‚≠ê –õ–µ–≥–∫–æ</option>
            <option value="medium">‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
            <option value="hard">‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="task-deadline">–í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ</label>
          <input type="date" id="task-deadline" class="form-input" />
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
  <div id="modal-task-edit" class="modal" style="display: none">
    <div class="modal-content">
      <div class="modal-header">
        <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h2>
        <div class="modal-header-actions">
          <button id="task-edit-cancel-btn" class="modal-btn-secondary cancel">–û—Ç–º–µ–Ω–∞</button>
          <button id="task-edit-save-btn" class="modal-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
      <div class="modal-body">
        <input type="hidden" id="task-edit-id">
        <div class="form-group">
          <label for="task-edit-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫*</label>
          <input type="text" id="task-edit-title" placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ" class="form-input" required />
        </div>
        <div class="form-group">
          <label for="task-edit-notes">–ó–∞–º–µ—Ç–∫–∏</label>
          <textarea id="task-edit-notes" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" class="form-input" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="task-edit-difficulty">–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
          <select id="task-edit-difficulty" class="form-input">
            <option value="trivial">‚≠ê –ü—É—Å—Ç—è–∫</option>
            <option value="easy">‚≠ê‚≠ê –õ–µ–≥–∫–æ</option>
            <option value="medium">‚≠ê‚≠ê‚≠ê –ù –Ω–æ—Ä–º–∞–ª—å–Ω–æ</option>
            <option value="hard">‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="task-edit-deadline">–í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ</label>
          <input type="date" id="task-edit-deadline" class="form-input" />
        </div>
        <div class="form-group">
          <button id="task-delete-btn" class="btn-delete">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16">
              <path fill-rule="evenodd" d="M3 14h8V4H3v10zM14 4h-1v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4H0V2h4V1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1h4v2zm-6 8h1V6H8v6zm-3 0h1V6H5v6z"></path>
            </svg>
            –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ -->
  <div id="modal-habit-edit" class="modal" style="display: none">
    <div class="modal-content">
      <div class="modal-header">
        <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É</h2>
        <div class="modal-header-actions">
          <button id="habit-edit-cancel-btn" class="modal-btn-secondary cancel">–û—Ç–º–µ–Ω–∞</button>
          <button id="habit-edit-save-btn" class="modal-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
      <div class="modal-body" style="padding: 24px 32px;">
        <input type="hidden" id="habit-edit-id">
        <div class="form-group" style="margin-bottom: 18px;">
          <label for="habit-edit-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫*</label>
          <input type="text" id="habit-edit-title" required placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ" class="form-input"/>
        </div>
        <div class="form-group" style="margin-bottom: 0;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <label for="habit-edit-notes">–ó–∞–º–µ—Ç–∫–∏</label>
          </div>
          <textarea id="habit-edit-notes" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" class="form-input" rows="3"></textarea>
        </div>
        <div class="form-group">
          <div>
            <label for="habit-edit-difficulty">–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
          </div>
          <select id="habit-edit-difficulty" class="form-input">
            <option value="trivial">‚≠ê –ü—É—Å—Ç—è–∫</option>
            <option value="easy">‚≠ê‚≠ê –õ–µ–≥–∫–æ</option>
            <option value="medium">‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
            <option value="hard">‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="habit-edit-start-date">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
          <input type="date" id="habit-edit-start-date" class="form-input"/>
        </div>
        <div class="form-group">
          <label for="habit-edit-repeat-type">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
          <select id="habit-edit-repeat-type" class="form-input">
            <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –¥–µ–ª–æ</option>
            <option value="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
            <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
            <option value="yearly">–ï–∂–µ–≥–æ–¥–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="habit-edit-repeat-every">–ü–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—ã–π</label>
          <div style="display: flex; align-items: center; gap: 12px;">
            <input type="number" id="habit-edit-repeat-every" min="1" max="999" value="1" class="form-input"/>
            <span id="habit-edit-repeat-label">–Ω–µ–¥–µ–ª—é</span>
          </div>
        </div>
        <div class="form-group">
          <label>–ü–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ</label>
          <div class="days-selector">
            <button type="button" class="day-toggle" data-day="0">–í—Å</button>
            <button type="button" class="day-toggle" data-day="1">–ü–Ω</button>
            <button type="button" class="day-toggle" data-day="2">–í—Ç</button>
            <button type="button" class="day-toggle" data-day="3">–°—Ä</button>
            <button type="button" class="day-toggle" data-day="4">–ß—Ç</button>
            <button type="button" class="day-toggle" data-day="5">–ü—Ç</button>
            <button type="button" class="day-toggle" data-day="6">–°–±</button>
          </div>
        </div>
        <div class="form-group">
          <button id="habit-delete-btn" class="btn-delete">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16">
              <path fill-rule="evenodd" d="M3 14h8V4H3v10zM14 4h-1v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4H0V2h4V1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1h4v2zm-6 8h1V6H8v6zm-3 0h1V6H5v6z"></path>
            </svg>
            –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ -->
  <div id="modal-habit" class="modal" style="display: none">
    <div class="modal-content">
      <div class="modal-header">
        <h2>–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É</h2>
        <div class="modal-header-actions">
          <button id="habit-cancel-btn" class="modal-btn-secondary cancel">–û—Ç–º–µ–Ω–∞</button>
          <button id="habit-create-btn" class="modal-btn">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
      </div>
      <div class="modal-body" style="padding: 24px 32px;">
        <div class="form-group" style="margin-bottom: 18px;">
          <label for="habit-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫*</label>
          <input type="text" id="habit-title" required placeholder="–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ" class="form-input"/>
        </div>
        <div class="form-group" style="margin-bottom: 0;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <label for="habit-notes">–ó–∞–º–µ—Ç–∫–∏</label>
          </div>
          <textarea id="habit-notes" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É" class="form-input" rows="3"></textarea>
        </div>
        <div class="form-group">
          <div>
            <label for="habit-difficulty">–°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
          </div>
          <select id="habit-difficulty" class="form-input">
            <option value="trivial">‚≠ê –ü—É—Å—Ç—è–∫</option>
            <option value="easy" selected>‚≠ê‚≠ê –õ–µ–≥–∫–æ</option>
            <option value="medium">‚≠ê‚≠ê‚≠ê –ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
            <option value="hard">‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="habit-start-date">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
          <input type="date" id="habit-start-date" class="form-input"/>
        </div>
        <div class="form-group">
          <label for="habit-repeat-type">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
          <select id="habit-repeat-type" class="form-input">
            <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –¥–µ–ª–æ</option>
            <option value="weekly" selected>–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
            <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
            <option value="yearly">–ï–∂–µ–≥–æ–¥–Ω–æ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="habit-repeat-every">–ü–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—ã–π</label>
          <div style="display: flex; align-items: center; gap: 12px;">
            <input type="number" id="habit-repeat-every" min="1" max="999" value="1" class="form-input"/>
            <span id="habit-repeat-label">–Ω–µ–¥–µ–ª—é</span>
          </div>
        </div>
        <div class="form-group">
          <label>–ü–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ</label>
          <div class="days-selector">
            <button type="button" class="day-toggle" data-day="0">–í—Å</button>
            <button type="button" class="day-toggle active" data-day="1">–ü–Ω</button>
            <button type="button" class="day-toggle active" data-day="2">–í—Ç</button>
            <button type="button" class="day-toggle active" data-day="3">–°—Ä</button>
            <button type="button" class="day-toggle active" data-day="4">–ß—Ç</button>
            <button type="button" class="day-toggle active" data-day="5">–ü—Ç</button>
            <button type="button" class="day-toggle" data-day="6">–°–±</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>